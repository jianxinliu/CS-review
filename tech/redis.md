# redis 知识简单汇总

## 什么是 Redis

高性能的 key-value 缓存数据库。

五种基本数据:

1. string
2. hash
3. set
4. zset
5. list

## 优点

1. 基于内存，读写性能优异
2. 支持持久化方式: AOF, RDB
3. 支持事务。所有操作都是原子性的。
4. 丰富的数据结构
5. 支持主从复制、哨兵模式

## 为什么这么快

1. 完全基于内存
2. 数据结构简单
3. 单线程，避免不必要的上下文切换和线程竞争，不用考虑锁的问题。注意，redis 只是使用单线程处理客户端请求，并不是完全是一个单线程应用。如生成 RDB 文件就会在子进程中进行。
4. 使用多路 I/O 复用模型，非阻塞 I/O

什么是 I/O 多路复用

是指使用 `select`, `poll`, `epoll` 可以同时监察多个流的 I/O 事件，当监察的流有 I/O 事件时，轮训一遍所有真正发生事件的流，并依次处理就绪的流，这种做法避免了大量的无用操作。

`多路`是指多个网络连接，`复用`是指复用同一个处理线程。这样相比一个请求分配一个处理线程的方式，减少了线程分配与销毁、线程维护等工作。

## 常用数据类型详解

1. string 。 支持简单键值对存储
2. list。 
3. set。 不重复的无序集合。除一般操作外，还在支持集合的交并差操作。
4. hash。包含键值对的无序散列表。结构化的对象
5. zset。有序集合。支持去重和排序。

## 持久化

1. RDB（default）Redis DataBase 快照。定时将内存中的数据保存为快照到磁盘上，产生 dump.rdb 文件。fork 子进程来做 RDB ，主进程依旧处理命令。备份粒度大。
2. AOF（Append-only File）保存 redis 执行的命令为 aof 文件。重启时将所有命令再次执行即可重现。备份粒度小A。


## 集群化

### 哨兵模式（Sentinel）

负责监控主从节点工作是否正常，自动转移故障，实现高可用。哨兵本身也是集群模式运行，涉及分布式选举的问题。

## 缓存异常

穿透、雪崩

### 缓存穿透

请求穿过缓存直接到达 DB，导致 DB 压力增加，失去了缓存的意义。

解决方法：

1. 接口层增加校验
2. 布隆过滤器

### 缓存雪崩


